{% extends 'core/base.html' %} {% block title %}Главная страница{% endblock %}
{% load static %}

{% load static %}

{% block content %}
  <div class="row main-content">
    

    <div class="col col-main">
      

      <div class="content-rec expense-form">
        <div class="btn-chose-form">
          <div class="btn-group btn-group-toggle" data-toggle="buttons" >
            <label class="btn btn-secondary active">
              <input type="radio" autocomplete="off" name="form-choose" {% if visible_form == 'expense' %} checked {% endif %} onclick="chooseForm('expense')" />Расход
            </label>
            <label class="btn btn-secondary ">
              <input type="radio" name="form-choose" {% if visible_form == 'income' %} checked {% endif %} onclick="chooseForm('income')" /> Приход
            </label>
          </div>
        </div>
        <form method="POST"  class="my-form  {% if visible_form != 'expense' %}invisible{% endif %}" id="main-page__expence-form" action="{% url 'core:main' %}"  >
          {% csrf_token %}
          <input type="text" name="form" hidden value="expf">
          {% include "core/base_form.html" with form=expence_form %}
        </form>
        <form method="POST" class="my-form {% if visible_form != 'income' %}invisible{% endif %}" id="main-page__income-form" action="{% url 'core:main' %}">
          {% csrf_token %}
          <input type="text" name="form" hidden value="incf">
          {% include "core/base_form.html" with form=income_form%}
        </form>
      </div>
    </div>

    
    
    <div class="col col-main-center">
      <div class="content-rec expenses-diag" id="expenses">
      </div>
      {% if account_list %}
        <div class="content-rec balance">
          <h5 class="text-center">Баланс</h5><br>
          {% for account in account_list %}
              <h6>{{ account.name }}: <small>{{account.amount | floatformat:2}}р.</small></h6>
          {% endfor %}
        </div>
      {% else %}
        <p>No accounts are available.</p>
      {% endif %}
      
      <div class="content-rec expenses">
        <h5 class="text-center">За этот месяц</h5><br>
        {% for exp in expenses %}
          <h6>{{exp.name}}: <small>{{exp.value | floatformat:2}}</small></h6>
        {% endfor %}
      </div>
    </div>

    

    <div class="col col-main">
        <div class="content-rec history-log">
            <h5 class="text-center">Последние транзакции</h5>
        </div>
    </div>

  </div>
  <div class="row" id='main-page__expense-chart'></div>
{% endblock %}

{% block javascript%}
  <script type="text/javascript" src="{% static 'js/main.js' %}"></script>
  <script type="text/javascript">
    let data = [
      ['Категория', 'Сумма расходов'],
      {% for tran in expense_chart_data %}
          ['{{tran.to}}', '{{tran.amount}}'],
      {% endfor %}
    ]
    google.charts.load("current", {packages:["corechart"]});
    google.charts.setOnLoadCallback(() => drawChart(data));
  </script>
{% endblock %}

{% block javascript1 %}
  <script src="{% static 'js/script.js' %}"></script>
{% endblock %}

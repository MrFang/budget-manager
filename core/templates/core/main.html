{% extends 'core/base.html' %} {% block title %}Главная страница{% endblock %}
{% load static %}

{% block content %}
  <div class="row">
    
    <div class="left-forms">

        <div class="features expense-form">
            <form method="POST" action="{% url 'core:main' %}">
              {% csrf_token %}
              <h5 class="text-center">Расход</h5>
              <input type="text" name="form" hidden value="expf">
              {% include "core/base_form.html" with form=expence_form %}
            </form>
        </div>

        <div class="features income-form">
          <form method="POST" action="{% url 'core:main' %}">
            {% csrf_token %}
            <h5 class="text-center">Приход</h5>
            <input type="text" name="form" hidden value="incf">
            {% include "core/base_form.html" with form=income_form%}
          </form>
        </div>
    </div>


    
    <div class="col">
      {% if account_list %}
        <ul>

        {% for account in account_list %}
          <li><h5>{{ account.name }}: <small>{{account.amount | floatformat:2}}р.</small></h5></li>
        {% endfor %}

        </ul>
      {% else %}
        <p>No accounts are available.</p>
      {% endif %}
    </div>

    

    <div class="col">
        <div class="features history-log">
            <h5 class="text-center">Последние транзакции</h5>
        </div>
    </div>

  </div>
  <div class="row" id='main-page__expense-chart'></div>
{% endblock %}

{% block javascript%}
  <script type="text/javascript" src="{% static 'js/main.js' %}"></script>
  <script type="text/javascript">
    let data = [
      ['Категория', 'Сумма расходов'],
      {% for tran in expense_chart_data %}
          ['{{tran.to}}', '{{tran.amount}}'],
      {% endfor %}
    ]
    google.charts.load("current", {packages:["corechart"]});
    google.charts.setOnLoadCallback(() => drawChart(data));
  </script>
{% endblock %}
